var CurrentDate=new Date(),TimeZoneOffset=-CurrentDate.getTimezoneOffset()/60,regDBDate=new RegExp('^([0-9]{4})\-([0-9]|[1][0-9]|[1][0,1,2])\-([0-9]|[0,1,2][0-9]|[3][0,1])$',""),regDBDateTimeTZ=new RegExp('^([0-9]{4})\-([0-9]|[0][0-9]|[1][0,1,2])\-([0-9]|[0,1,2][0-9]|[3][0,1])[ T]([0-2][0-9]):([0-6][0-9])Z?$',"");var date_format,datetime_format,time_format;var iOS=(navigator.userAgent.match(/(iPad|iPhone|iPod)/i)?true:false);var available_languages={'en':'en_us','fr':'fr_FR','es':'es_es','sp':'es_es','it':'it_it','de':'de_de'};function AppReload(){if(mobile_app&&!iOS&&navigator.app!==undefined){navigator.app.loadUrl("file:///android_asset/www/app.htm")}else{$.mobile.changePage("#LoginPage");location.reload()}}function GetLanguage(){try{var lang,lang1;if(navigator&&navigator.userAgent&&(lang1=navigator.userAgent.match(/android.*\W(\w\w)-(\w\w)\W/i))){if(lang1&&lang1[1])lang=lang1[1]}if(!lang&&navigator){if(navigator.language){lang=navigator.language}else if(navigator.browserLanguage){lang=navigator.browserLanguage}else if(navigator.systemLanguage){lang=navigator.systemLanguage}else if(navigator.userLanguage){lang=navigator.userLanguage}lang=lang.substr(0,2)}if(!lang)lang='en'}catch(err){lang='en'}return lang}function getAppLanguage(){var app_languages={'en':'en_us','fr':'fr_FR','es':'es_es','sp':'es_es','de':'de_de'};var lg=GetLanguage();return app_languages[lg]===undefined?'en_us':app_languages[lg]}function getMobileLanguage(){var lg=GetLanguage();return available_languages[lg]===undefined?'en_us':available_languages[lg]}function getSugarLanguage(sugar_languages,default_language){var lg1=GetLanguage(),res;for(var l in sugar_languages){var lg=l.substring(0,2);if(lg===lg1||(lg1==='es'&&lg==='sp')){res=l;break}}if(res===undefined)res=default_language;return res}Date.prototype.addHours=function(h){this.setTime(this.getTime()+(h*3600000));return this};Date.prototype.isDST=function(){var tz=this.getTimezoneOffset(),D1=new Date(),m=0;while(m<12){D1.setMonth(++m);if(D1.getTimezoneOffset()>tz)return true;if(D1.getTimezoneOffset()<tz)return false}return false};if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'')}}function getDateTimeFormats(name_value_list){if(typeof GetDemo==='function'){if(GetDemo())name_value_list=null}if(name_value_list&&name_value_list.user_default_dateformat!==undefined){switch(name_value_list.user_default_dateformat.value){case'Y-m-d':date_format='yyyy-mm-dd';break;case'm-d-Y':date_format='mm-dd-yyyy';break;case'd-m-Y':date_format='dd-mm-yyyy';break;case'Y/m/d':date_format='yyyy/mm/dd';break;case'm/d/Y':date_format='mm/dd/yyyy';break;case'd/m/Y':date_format='dd/mm/yyyy';break;case'Y.m.d':date_format='yyyy.mm.dd';break;case'd.m.Y':date_format='dd.mm.yyyy';break;case'm.d.Y':date_format='mm.dd.yyyy';break;default:date_format='mm/dd/yyyy'}if(name_value_list.user_default_timeformat.value==='H:i'||name_value_list.user_default_timeformat.value==='H.i'){AMPM=false;time_format='HH:ii'}else{AMPM=true;time_format='hh:ii A'}}else{var l=GetLanguage();try{AMPM=(l==='en');date_format=(l==='en')?'mm/dd/yyyy':jQuery.mobiscroll.i18n[l].dateFormat;time_format=(l==='en')?'hh:ii A':jQuery.mobiscroll.i18n[l].timeFormat}catch(err){AMPM=true;date_format='mm/dd/yyyy';time_format='hh:ii A'}}localStorage.setItem("date_format",date_format);localStorage.setItem("time_format",time_format);datetime_format=date_format+' '+time_format}function toDBDate(date){if(date===null||date==='')return'';var year=date.getFullYear().toString(),month=date.getMonth()+1,day=date.getDate();month=((month<10)?"0":"")+month.toString();day=((day<10)?"0":"")+day.toString();return year+"-"+month+"-"+day}function toDBDateTime(date,tz){if(date===null||date==='')return'';if(tz!==false){date=date.addHours(-TimeZoneOffset);if(!date.isDST())date=date.addHours(1)}var hours=date.getHours(),min=date.getMinutes();if(hours===0){hours="00"}else hours=((hours<10)?"0":"")+hours.toString();if(min===0){min="00"}else min=((min<10)?"0":"")+min.toString();return toDBDate(date)+' '+hours+':'+min+":00"}function fromDBDate(value){return new Date(value.substring(0,4),parseInt(value.substring(5,7),10)-1,value.substring(8,10))}function fromDBDateTime(value){if(value.length<14)return new Date();var day=value.substring(8,10),month=parseInt(value.substring(5,7),10),year=parseInt(value.substring(0,4),10),hour=parseInt(value.substring(11,13),10),min=parseInt(value.substring(14,16),10),dt=new Date(year,month-1,day,hour.toString(),min,0,0);dt=dt.addHours(TimeZoneOffset);if(!dt.isDST()){dt=dt.addHours(-1)}return dt}function toDBDateString(datestring){if(datestring===''){return''}else if(Modernizr.inputtypes.date||regDBDate.test(datestring)){return datestring}else{var month=datestring.replace(regDate,regMonth);if(month.length===1)month="0"+month;var day=datestring.replace(regDate,regDay);if(day.length===1)day="0"+day;return datestring.replace(regDate,'$3-'+month+'-'+day)}}function toDBDateTimeString(datestring){if(datestring===''){return''}else{datestring=datestring.substr(0,16).replace('T',' ').replace('Z','');var year,month,day,hour,min,dt;if(regDBDateTimeTZ.test(datestring)){year=datestring.replace(regDBDateTimeTZ,'$1');month=datestring.replace(regDBDateTimeTZ,'$2');day=datestring.replace(regDBDateTimeTZ,'$3');hour=datestring.replace(regDBDateTimeTZ,'$4');min=datestring.replace(regDBDateTimeTZ,'$5')}else{day=datestring.replace(regDateTime,regDay);month=datestring.replace(regDateTime,regMonth);hour=datestring.replace(regDateTime,'$4');min=datestring.replace(regDateTime,'$5');year=datestring.replace(regDateTime,'$3')}dt=new Date(year,month-1,day,hour,0,0,0);dt=dt.addHours(-TimeZoneOffset);if(!dt.isDST()){dt=dt.addHours(1)}year=dt.getFullYear().toString();month=1+dt.getMonth();month=(month<10?"0":"")+month.toString();day=dt.getDate();day=(day<10?"0":"")+day.toString();hour=dt.getHours();hour=(hour<10?"0":"")+hour.toString();min=parseInt(min,10);min=(min<10?"0":"")+min.toString();return year+'-'+month+'-'+day+' '+hour+':'+min+':00'}}function checkDateTimeString(datestring){if((datestring==='')||Modernizr.inputtypes.datetime||OptDatePicker){return true}else{if(regDBDateTimeTZ.test(datestring)){return true}else{return regDateTime.test(datestring)}}}function checkDateString(datestring){if((datestring==='')||Modernizr.inputtypes.date||OptDatePicker){return true}else{if(regDBDate.test(datestring)){return true}else{return regDate.test(datestring)}}}function HTMLDecode(s){return jQuery('<div></div>').html(s).text()}